# nhp-modeling-pipeline
Scripts used to process MRI-derived tissue masks into smooth meshes for FEM simulations.

These scripts take the whole head segmentation of a nonhuman primate (NHP) structural MRI and creates surfaces of each tissue, gray matter layer depths, and a volumetric mesh of the head for use in SimNIBS to simulate
the induced electric field generated by transcranial magnetic stimulation (TMS).

Following SPM-based segmentation, the individual tissue files are combined into one file using nii_combine.m. Manual corrections can be done on that file using MRI editing software such as ITK-SNAP.
The completed segmentation file is then split apart into tissue masks using export_masks.m.
Finally, using tools from FSL, Freesurfer, and SimNIBS, the tissue masks are voxelized into surfaces and combined into a volumetric mesh that can be used in SimNIBS with mesh_tissues.sh. This script must be used in 
Linux (or a virtual machine running Linux).
Optionally, the gray matter mask can be stratified into layers using the generate_cortical_layers.py. This python scripts requires the nighres library.
